{{ config(materialized = 'table') }}

WITH wsj AS (
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251014_123025
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251014_160103
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251015_093102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251015_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251015_160103
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251016_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251016_160102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251017_093102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251017_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251017_160102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251022_093103
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251022_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251022_160102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251023_093102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251023_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251023_160103
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251024_093102
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251024_123003
    UNION ALL
    SELECT REGEXP_SUBSTR(UNNAMED__0, '\\(([^)]+)\\)', 1, 1, 'e', 1) AS symbol
    FROM DS2508.VKX7SS.WSJGAINERS_20251024_160103
),

yahoo AS (
    SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251014_123025
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251014_160103
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251015_093102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251015_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251015_160103
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251016_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251016_160102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251017_093102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251017_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251017_160102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251022_093103
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251022_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251022_160102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251023_093102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251023_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251023_160103
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251024_093102
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251024_123003
    UNION ALL SELECT SYMBOL AS symbol FROM DS2508.VKX7SS.YGAINERS_20251024_160103
)

SELECT DISTINCT symbol
FROM (
    SELECT symbol FROM wsj
    UNION ALL
    SELECT symbol FROM yahoo
)
WHERE symbol IS NOT NULL
